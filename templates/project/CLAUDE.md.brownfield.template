<!--
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
WORKFLOW BOOTSTRAP - CLAUDE MUST READ THIS FIRST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Project Type: BROWNFIELD (existing codebase)
Initialized: {{DATE}}

INSTRUCTIONS FOR CLAUDE:

1. READ the orchestrator: {{WORKFLOW_HOME}}/agents/workflow-orchestrator.md

2. THIS IS EXISTING CODE - Run brownfield-analyzer FIRST

3. FOLLOW agent utilization rules below (quality gates, debugging)

4. UPDATE state after each significant action

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-->

# {{PROJECT_NAME}}

## ðŸ”„ WORKFLOW ACTIVE (Brownfield)

This is an **existing codebase**. Workflow will analyze first.

**Claude: Run brownfield-analyzer FIRST, then follow Agent Utilization Guide.**

---

## Brownfield First-Run Protocol

```
SESSION START (if analysis.status == pending)
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ brownfield-analyzer                                                         â”‚
â”‚                                                                             â”‚
â”‚  1. Scan project structure                                                  â”‚
â”‚  2. Detect tech stack                                                       â”‚
â”‚  3. Identify features and completeness                                      â”‚
â”‚  4. Check existing tests                                                    â”‚
â”‚  5. Check existing documentation                                            â”‚
â”‚  6. Present findings to user                                                â”‚
â”‚                                                                             â”‚
â”‚  User confirms? â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚                      â”‚                                       â”‚              â”‚
â”‚                     YES                                     NO              â”‚
â”‚                      â”‚                                       â”‚              â”‚
â”‚                      â–¼                                       â–¼              â”‚
â”‚            Update CLAUDE.md state                    User corrects          â”‚
â”‚            Create [INFERRED] docs                    Re-analyze             â”‚
â”‚            Continue to L2                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Agent Utilization Guide

**Claude: These rules are MANDATORY. Follow them automatically.**

### Quality Gates (Same as Greenfield)

```
AFTER ANY CODE CHANGE:
â”‚
â”œâ”€â–º code-reviewer
â”‚   â€¢ Review new/modified files
â”‚   â€¢ Check: quality, security, intent compliance
â”‚
â”œâ”€â–º Run tests (if exist)
â”‚   â€¢ Must pass before continuing
â”‚
â””â”€â–º Update CLAUDE.md state
```

### L2 Building Flow (Per Feature)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FEATURE: [name]                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  backend-engineer â”€â”€â–º code-reviewer â”€â”€â–º tests â”€â”€â–º PASS? â”€â”€â–º Continue       â”‚
â”‚                                                     â”‚                       â”‚
â”‚                                               FAIL? â–¼                       â”‚
â”‚                                               debugger (fix)                â”‚
â”‚                                                     â”‚                       â”‚
â”‚  frontend-engineer â”€â”€â–º code-reviewer â”€â”€â–º tests â”€â”€â–º ui-debugger â”€â”€â–º PASS?   â”‚
â”‚                                                                     â”‚       â”‚
â”‚                                                               FAIL? â–¼       â”‚
â”‚                                                         debugger/ui-debuggerâ”‚
â”‚                                                                     â”‚       â”‚
â”‚  test-engineer â”€â”€â–º Run ALL tests â”€â”€â–º PASS? â”€â”€â–º FEATURE COMPLETE            â”‚
â”‚                                        â”‚                                    â”‚
â”‚                                  FAIL? â–¼                                    â”‚
â”‚                                  Fix and retry                              â”‚
â”‚                                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FEATURE COMPLETE:                                                           â”‚
â”‚   â€¢ project-ops sync                                                        â”‚
â”‚   â€¢ Update [INFERRED] docs â†’ mark as verified                               â”‚
â”‚   â€¢ CI verification                                                         â”‚
â”‚   â€¢ Continue to next feature                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Issue Response Protocol

```
USER REPORTS ISSUE
       â”‚
       â”œâ”€â”€â”€ UI issue â”€â”€â”€â”€â”€â”€â–º ui-debugger
       â”‚                        â”‚
       â”‚                        â–¼
       â”‚                     Screenshot, console, diagnose, fix
       â”‚
       â”œâ”€â”€â”€ Runtime issue â”€â”€â–º debugger
       â”‚                        â”‚
       â”‚                        â–¼
       â”‚                     Trace, diagnose, fix, add test
       â”‚
       â”œâ”€â”€â”€ Test failure â”€â”€â”€â–º debugger + test-engineer
       â”‚                        â”‚
       â”‚                        â–¼
       â”‚                     Analyze, fix code or test, verify
       â”‚
       â””â”€â”€â”€ After ANY fix:
                â”‚
                â–¼
            code-reviewer â”€â”€â–º tests â”€â”€â–º update state
```

### CI/CD Verification

```
BEFORE FEATURE COMPLETE:

  Run local CI simulation:
  â€¢ Lint check
  â€¢ Type check
  â€¢ All tests
  â€¢ Build

  ALL MUST PASS

AFTER FEATURE COMPLETE:

  Suggest: /project commit, /project push, /project pr
```

### Agent Quick Reference

| Agent | Auto/Manual | Trigger |
|-------|-------------|---------|
| brownfield-analyzer | AUTO | First run on brownfield |
| code-reviewer | AUTO | After ANY code changes |
| ui-debugger | AUTO | After frontend (if puppeteer) |
| debugger | MANUAL | User reports issue |
| test-engineer | AUTO | L2 testing phase |
| project-ops | AUTO | After milestones |

---

## Project Context

> {{PROJECT_DESCRIPTION}}

### Key Decisions

- [Document important decisions here]

### Notes

- [Add project notes, context, constraints]

---

## Session Resume

**First session (analysis not done):**
1. Run brownfield-analyzer
2. Present findings to user
3. On confirmation, update state below
4. Create [INFERRED] documentation
5. Continue from inferred state

**Subsequent sessions:**
1. Read the Workflow State below
2. Announce: "Resuming [project] - [current state]. Continue?"
3. Continue from saved position

**Current Status:**
- Analysis: Not done
- Next: Run brownfield-analyzer to scan codebase

---

## Workflow State
```yaml
workflow:
  version: 1.0
  type: brownfield
  phase: analysis              # analysis, L1, L2
  status: not_started
  mode: auto
  initialized: {{DATE}}

analysis:
  status: pending              # pending, in_progress, complete
  completed_at: null

  # Will be populated by brownfield-analyzer:
  detected:
    stack: null                # { frontend: "React", backend: "Express", ... }
    features: {}               # { auth: { status: "complete", ... }, ... }
    documentation: {}          # { readme: true, api_docs: false, ... }
    test_coverage: null        # estimated percentage

  # User can correct the analysis:
  corrections: []

l1:
  # For brownfield, L1 docs are [INFERRED] from existing code
  intent:
    status: pending
    source: inferred           # "inferred" or "created"
    output: null
    reviewed: false            # User should review inferred docs
  ux:
    status: pending
    source: inferred
    output: null
    reviewed: false
  architecture:
    status: pending
    source: inferred
    output: null
    reviewed: false
  planning:
    status: pending
    source: inferred
    output: null
    reviewed: false

l2:
  current_feature: null
  current_step: null
  features: {}
  # Will be populated from analysis

quality:
  last_review: null
  last_review_result: null     # pass, fail
  last_test_run: null
  last_test_result: null       # pass, fail
  open_issues: []

promises:
  # Populated from intent doc (inferred or created), tracked through completion
  # Format:
  # PRM-001:
  #   statement: "Auto-save every 30 seconds"
  #   criticality: CORE|IMPORTANT|NICE_TO_HAVE
  #   implementing_module: "auto_save_service"
  #   status: pending|in_progress|validated|partial|failed
  #   validated_at: null
  #   acceptance_results: {}
  #   evidence: []
  #   issues: []

validation:
  last_run: null
  last_result: null            # pass, partial, fail
  coverage:
    core_validated: 0
    core_total: 0
    important_validated: 0
    important_total: 0

ci:
  last_check: null
  status: null                 # pass, fail, not_configured

session:
  last_updated: {{DATE}}
  last_action: "Project initialized as brownfield"
  next_action: "Run brownfield-analyzer to scan existing code"
  session_count: 0
```

---

## Workflow Commands

| Command | Description |
|---------|-------------|
| `/help` | Show all commands |
| `/status` | Show project progress |
| `/workflow analyze` | Re-run brownfield analysis |
| `/review [path]` | Code review files |
| `/debug [issue]` | Start debug session |
| `/project commit` | Conventional commit |
| `/workflow status` | Show workflow state |
